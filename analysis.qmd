---
title: Analysis
description: Here we provide a detailed analysis using more sophisticated statistics techniques.
toc: true
draft: false
---

![](images/analysis.webp)

Urban violence remains a pervasive challenge that affects cities worldwide. In Boston, variations in violent crime rates across different neighborhoods suggest a complex interplay of socioeconomic factors. This study aims to dissect the relationship between socioeconomic status—measured through variables such as income, employment, and education—and the frequency of gun violence within Boston's diverse districts. By exploring these relationships, the study seeks to identify potential mechanisms for policy action that could mitigate violence and enhance urban safety.

Our analysis revolves around several pivotal questions: Does higher income correlate with lower incidences of gun violence? What role does employment stability play in mitigating urban violence? How does educational attainment influence these dynamics? We hypothesized that higher socioeconomic status, indicated by increased income levels, stable employment, and higher educational attainment, is associated with reduced instances of gun violence. To test these hypotheses, we employ statistical models, including linear and logistic regressions, to examine these relationships, focusing on extracting meaningful patterns from a decade of data. This approach allows us to assess the strength and significance of these socioeconomic factors in relation to urban violence, providing a data-driven basis for recommendations and policy considerations.

#### **Analysis**

analysis summary: focus on R-squared/adjusted R-squared, our models capture a majority of the variance in our dependent variable, total cases. Therefore, our choice of variables are good indicators and have substantial predictive power for the number of incidents in a given district. #Outline: #summary statistics: correlations of our independent variables with total cases, correlation table seems intuitive, for example as unemployment increases, total cases also increase. Show the distribution of our variables, include more creative plots for appeal, reference tidycensus,Rfor data science books.

#Modeling: good R-Squared, above 90 for adjusted R-squared which is key, look at the relationship across spatial, socio economic, and racial features, geospatial analysis to weight the proximity of our locations, plot Beta, where is our regressors more impactful?, compare to segregation index and map.

```{r setup, echo=FALSE, results='hide'}
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```

```{r echo=FALSE, results='hide'}

suppressMessages(suppressWarnings({
  library(tidycensus)
  library(tidyverse)
  library(sandwich)
  library(lmtest)
  library(car)
  library(leaps)
  library(segregation)
  library(tigris)
  library(sf)
  library(olsrr)
  library(GWmodel)
  final_df<-readRDS('all_census_dat.rdr')
}))

#correlation table for all independent variables
independent_dat<-final_df%>%
  group_by(district_name)%>%
  summarise(aian_pct = mean(American_Indian_and_Alaska_Native_alone/total_pop),
            nhpt_pct = mean(Native_Hawaiian_and_Other_Pacific_Islander_alone/total_pop), 
            asian_pct = mean(Asian_alone/total_pop),
            pct_black = mean(Black_or_African_American_alone/total_pop),
            pct_white = mean(White_alone/total_pop),
            unemployment=mean(not_in_labor_force/total_pop),
            medincome_mean= mean(household_medincome),
            bachelors = mean(bachelors_25/total_pop),
            one_parent= mean(one_parent/total_house_units),
            married_house= mean(married_households/total_house_units),
            vacant_houses = mean(vacancy_status/total_house_units),
            total_cases = sum(!duplicated(incident_num)))%>%
  select(-district_name,-total_cases)

dependent_dat<-final_df%>%
  group_by(district_name)%>%
  summarise(total_cases = sum(!duplicated(incident_num)))

correlation_coeffs <- cor(dependent_dat$total_cases, independent_dat)

variable_names <- colnames(independent_dat)
correlation_values <- as.vector(correlation_coeffs)

correlation_df <- data.frame(
  Variable = variable_names,
  Correlation_Coefficient = correlation_values
)

print(correlation_df)

```

```{r echo=FALSE, results = 'hide'}
#ols all variables 

lm_dat<-final_df%>%
  group_by(district_name, year)%>%
  summarise(aian_pct = mean(American_Indian_and_Alaska_Native_alone/total_pop),
            nhpt_pct = mean(Native_Hawaiian_and_Other_Pacific_Islander_alone/total_pop), 
            asian_pct = mean(Asian_alone/total_pop),
            pct_black = mean(Black_or_African_American_alone/total_pop),
            pct_white = mean(White_alone/total_pop),
            unemployment=mean(not_in_labor_force/total_pop),
            medincome_mean= mean(household_medincome),
            bachelors = mean(bachelors_25/total_pop),
            one_parent= mean(one_parent/total_house_units),
            married_house= mean(married_households/total_house_units),
            vacant_houses = mean(vacancy_status/total_house_units),
            travel_work = mean(aggregate_time_to_work),
            total_cases = sum(!duplicated(incident_num)))

#OLS with all variables 
ols<-lm(total_cases~travel_work+ pct_white+pct_black+asian_pct+nhpt_pct+aian_pct+district_name+ unemployment+ medincome_mean+bachelors+one_parent+ vacant_houses+married_house, data = lm_dat)
coeftest(ols, vcov. = vcovHC) # data is heteroskedastic, opted to use the heteroskedastic robust standard errors 
summary(ols) 
vif(ols) #variables highly correlated, high pvalues, sign of coefficients opposite of their correlation,where you live is the best predictor of the total number of cases, 

ols_step_forward_p(ols)
#attempted variable selection, all the districts were retained, hence their predictive power, travel_work, income, married households also selected based on their significance, 

```

```{r echo=FALSE, results ='hide'}
#socio economic and race 

ols<-lm(total_cases~ asian_pct+pct_white+pct_black+nhpt_pct+aian_pct+travel_work+unemployment+medincome_mean+bachelors+one_parent+married_house, data = lm_dat)
coeftest(ols, vcov. = vcovHC)
vif(ols)
ols_step_forward_p(ols) # medium income,bachelors,pct_asian, pct_white significant 5% level, one_parent,travel_work at 10%

#coefficeint signs alot more interpretable and align with correlation direction, 

#probably should add one more regression with interaction terms 

```

```{r echo=FALSE, results = 'hide'}

#map segregation index, relied on tidycensus book 

race_data<-c("White_alone", "Black_or_African_American_alone",
             "American_Indian_and_Alaska_Native_alone",
             "Asian_alone", "Native_Hawaiian_and_Other_Pacific_Islander_alone")


pivot_race<-final_df%>%
  group_by(year, GEOID_TRACT_20)%>%
  pivot_longer(race_data,names_to ='ethnicity',values_to = 'population_count')%>%
  ungroup()%>%
  group_by(ethnicity, GEOID_TRACT_20)%>%
  summarise(mean_population_count = mean(population_count))

#print(pivot_race, n =100)

boston_local_seg <- pivot_race %>%
  mutual_local(
    group = "ethnicity",
    unit = "GEOID_TRACT_20",
    weight = "mean_population_count", 
    wide = TRUE
  )%>%
  rename(GEOID = GEOID_TRACT_20)

boston_local_seg$GEOID<-as.character(boston_local_seg$GEOID)

MA_tracts_seg <- tracts("MA", cb = TRUE, year = 2020) %>%
  inner_join(boston_local_seg, by = "GEOID") 

with_geometry <- get_acs(
  geography = "tract",
  variables = c(total_house_units = 'B25001_001'),
  state = "MA",
  geometry = TRUE,
  year = 2021
)

MA_tracts_seg%>%
  ggplot(aes(fill = ls)) + 
  geom_sf(color = NA) + 
  coord_sf(crs = st_crs(with_geometry))+
  scale_fill_viridis_c(option = "inferno") + 
  theme_void() + 
  labs(fill = "Local\nsegregation index")


#compare this to geospatial weighted regression maps 

```

```{r echo=FALSE, results = 'hide'}

#Geography weighted Regression 

#Implemented with the GWmodel R package and spgwr package that offer a methods for a geographical robust weighted regreession
# The GWR model computes a local regression model for each location, while including a distance decay function, or a weight added to sum of linear combinations which specifies how observations outside the current location will be weighted
# relative to their distance. A kernel bandwith is implemented to determine the cutoff distnace for observations that will be included for a locations set of linear combinations
# The GWR model returns local parameter estimates, and the local R-squared quatifying how much variance was captured in a given area. We plot the R-squared statistic for each location in our data below
#


#best data to run this is just socio economic,
ols<-lm(total_cases~ unemployment+medincome_mean+bachelors+one_parent+ vacant_houses+married_house, data = lm_dat)
coeftest(ols, vcov. = vcovHC)
summary(ols)
vif(ols)
ols_step_forward_p(ols) #variable selction, use the subset, look at statistically significant variables, unemployment has good predictive power  



geo_dat<-final_df%>%
  group_by(district_name,year)%>%
  summarise(aian_pct = mean(American_Indian_and_Alaska_Native_alone/total_pop),
            nhpt_pct = mean(Native_Hawaiian_and_Other_Pacific_Islander_alone/total_pop), 
            asian_pct = mean(Asian_alone/total_pop),
            pct_black = mean(Black_or_African_American_alone/total_pop),
            pct_white = mean(White_alone/total_pop),
            unemployment=mean(not_in_labor_force/total_pop),
            medincome_mean= mean(household_medincome),
            bachelors = mean(bachelors_25/total_pop),
            one_parent= mean(one_parent/total_house_units),
            married_house= mean(married_households/total_house_units),
            vacant_houses = mean(vacancy_status/total_house_units),
            travel_work = mean(aggregate_time_to_work),
            total_cases = sum(!duplicated(incident_num)),
            geometry = geometry)%>%
  distinct()

geo_reg<-st_as_sf(geo_dat)%>%
  as_Spatial()

#limitation: travel_work has na values, cannot include this in model, even though it would be great to have that plotted 

#other variables we should add to aid analysis?

formula2 <- "total_cases~ unemployment+ vacant_houses+medincome_mean+bachelors+one_parent+married_house"

bw <- bw.gwr(
  formula = formula2, 
  data = geo_reg, 
  kernel = "bisquare",
  adaptive = TRUE
)

gw_model <- gwr.basic(
  formula = formula2, 
  data = geo_reg, 
  bw = bw,
  kernel = "bisquare",
  adaptive = TRUE
)

gw_model_results <- gw_model$SDF %>%
  st_as_sf() 

#map for R^2
ggplot(gw_model_results, aes(fill = Local_R2)) + 
  geom_sf(color = NA) + 
  scale_fill_viridis_c() + 
  theme_void()

#great R-squared and all of our variables are statistically significant at least 10% level, this is good

#map for beta, choose the fill variable/beta coefficient 

#where is the effect positive and negative, 
ggplot(gw_model_results, aes(fill = unemployment)) + 
  geom_sf(color = NA) + 
  scale_fill_viridis_c() + 
  theme_void() + 
  labs(fill = "Local β Unemployment")





```

#### **Limitations**

The analysis conducted in this study faces several potential issues related to the data that could impact the validity and reliability of the findings. Among these is the inconsistency in reporting across different districts, which may arise from variations in how incidents are classified or documented by different officers, leading to differences in data quality. Moreover, the dataset excludes justifiable and self-inflicted shootings, potentially skewing the comprehensive understanding of the city’s gun violence.

Additional challenges include potential biases in how incidents are reported. Systemic biases within law enforcement practices could influence reporting rates. For example, certain neighborhoods may experience underreporting due to strained community-police relations or resource constraints. Furthermore, differing enforcement practices could lead to an overrepresentation of certain demographics as victims, introducing biases that may distort the perceived demographic patterns of gun violence.

These factors call for a cautious interpretation of the study’s results and point to the need for further research. Incorporating variables such as police presence, public health initiatives, and community programs, could provide a fuller picture of the factors influencing urban violence. Moreover, while this study identifies correlations between socioeconomic status and gun violence, establishing causation requires additional longitudinal and experimental research to explore the underlying mechanisms more definitively.
